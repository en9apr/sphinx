

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>15. Multi-step Methods &mdash; The Visual Room</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="The Visual Room" href="index.html" />
    <link rel="next" title="1. 1D First-order Linear Convection - The Wave Equation" href="linear_convection.html" />
    <link rel="prev" title="14. New Schemes for Convection" href="new_convection_schemes.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>The Visual Room</span></a></h1>
        <h2 class="heading"><span>15. Multi-step Methods</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="new_convection_schemes.html">14. New Schemes for Convection</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="linear_convection.html">1. 1D First-order Linear Convection - The Wave Equation</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="multi-step-methods">
<h1>15. Multi-step Methods<a class="headerlink" href="#multi-step-methods" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#about-multi-step-methods" id="id1">About Multi-step methods</a></li>
<li><a class="reference internal" href="#richtmyer-lax-wendroff" id="id2">Richtmyer/Lax-Wendroff</a><ul>
<li><a class="reference internal" href="#variant-1-richtmyer-lax-friedrichs-and-leapfrog" id="id3">Variant 1 - Richtmyer (Lax-Friedrichs and Leapfrog)</a></li>
<li><a class="reference internal" href="#variant-2-2-step-lax-wendroff" id="id4">Variant 2 - 2 Step Lax-Wendroff</a></li>
</ul>
</li>
<li><a class="reference internal" href="#maccormack-method" id="id5">MacCormack Method</a></li>
</ul>
</div>
<p>Summary:</p>
<ul class="simple">
<li>Schemes presented for linear equations are not well-suited to the solution of <strong>non-linear</strong> problems</li>
<li>Multi-step methods work well in non-linear hyperbolic equations<ul>
<li>FD schemes at split time levels, also called &#8220;predictor-corrector&#8221; methods</li>
<li>Richtmyer/Lax-Wendroff</li>
<li>MacCormack</li>
</ul>
</li>
</ul>
<div class="section" id="about-multi-step-methods">
<h2><a class="toc-backref" href="#id1">15.1. About Multi-step methods</a><a class="headerlink" href="#about-multi-step-methods" title="Permalink to this headline">¶</a></h2>
<p>Multi-step are FD schemes are at split time levels and work well in <strong>non-linear hyperbolic problems</strong>. They are also called predictor-corrector methods.</p>
<ul class="simple">
<li>1st step, a &#8220;temporary value&#8221; for u(x) is &#8220;predicted&#8221;</li>
<li>2nd step a &#8220;corrected value&#8221; is computed</li>
</ul>
</div>
<div class="section" id="richtmyer-lax-wendroff">
<h2><a class="toc-backref" href="#id2">15.2. Richtmyer/Lax-Wendroff</a><a class="headerlink" href="#richtmyer-lax-wendroff" title="Permalink to this headline">¶</a></h2>
<p>Two variants:</p>
<ul class="simple">
<li>Variant 1 - Richtmyer - at point <span class="math">\(i\)</span></li>
<li>Variant 2 - 2 step LW - at point <span class="math">\(i + {1 \over 2}\)</span></li>
</ul>
<div class="section" id="variant-1-richtmyer-lax-friedrichs-and-leapfrog">
<h3><a class="toc-backref" href="#id3">15.2.1. Variant 1 - Richtmyer (Lax-Friedrichs and Leapfrog)</a><a class="headerlink" href="#variant-1-richtmyer-lax-friedrichs-and-leapfrog" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>Step 1: Predictor Step</strong> use LF method at time level <span class="math">\(n + {1 \over 2}\)</span></li>
</ul>
<div class="math">
\[{{u_i^{n+{1 \over 2}} - {1 \over 2} (u_{i+1}^n + u_{i-1}^n)} \over {{\Delta t} \over 2 } }
=-c{ {( {u_{i+1}^n - u_{i-1}^n})} \over {2 \Delta x}}\]</div>
<ul class="simple">
<li><strong>Step 2: Corrector Step</strong> Leapfrog with <span class="math">\({\Delta t} \over 2\)</span></li>
</ul>
<div class="math">
\[{{u_i^{n+1} - u_i^n} \over {\Delta t} }
=-c{ {( {u_{i+1}^{n+{1 \over 2}} - u_{i-1}^{n+{1 \over 2}}})} \over {2 \Delta x}}\]</div>
<p>Transpose Step 1 and 2 for outputs:</p>
<ul class="simple">
<li>Predictor:</li>
</ul>
<div class="math">
\[u_i^{n+{1 \over 2}} = {1 \over 2} (u_{i+1}^n + u_{i-1}^n) - {\sigma \over 4}(u_{i+1}^n - u_{i-1}^n)\]</div>
<ul class="simple">
<li>Corrector:</li>
</ul>
<div class="math">
\[u_i^{n+1} = u_i^{n-1} - {\sigma \over 2} (u_{i+1}^{n+{1 \over 2}} - u_{i-1}^{n+{1 \over 2}})\]</div>
<ul class="simple">
<li>Stable for Courant Number = <span class="math">\(\sigma = {{c \Delta t} \over {\Delta x}} \le 2\)</span> (possibly as a consequence of the half-time step in the method?)</li>
</ul>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/richtmyer.png"><img alt="_images/richtmyer.png" src="_images/richtmyer.png" style="width: 800.0px; height: 320.0px;" /></a>
</div>
</div>
<div class="section" id="variant-2-2-step-lax-wendroff">
<h3><a class="toc-backref" href="#id4">15.2.2. Variant 2 - 2 Step Lax-Wendroff</a><a class="headerlink" href="#variant-2-2-step-lax-wendroff" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>Step 1: Predictor Step</strong> use LF on <span class="math">\(i+{1 \over 2}\)</span></li>
</ul>
<div class="math">
\[u_{i+{1 \over 2}}^{n+{1 \over 2}} = {1 \over 2} (u_{i+1}^n + u_{i}^n) - {\sigma \over 2}(u_{i+1}^n - u_{i}^n)\]</div>
<ul class="simple">
<li><strong>Step 2: Corrector Step</strong> use FTCS</li>
</ul>
<div class="math">
\[u_i^{n+1} = u_i^{n} - {\sigma} (u_{i+{1 \over 2}}^{n+{1 \over 2}} - u_{i-{1 \over 2}}^{n+{1 \over 2}})\]</div>
<ul class="simple">
<li>Stable for Courant Number = <span class="math">\(\sigma = {{c \Delta t} \over {\Delta x}} \le 1\)</span></li>
</ul>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/2_step_LW_scheme.png"><img alt="_images/2_step_LW_scheme.png" src="_images/2_step_LW_scheme.png" style="width: 800.0px; height: 320.0px;" /></a>
</div>
<ul class="simple">
<li>This scheme is 2nd order</li>
<li>For linear PDEs it is equivalent to the single step LW</li>
</ul>
</div>
</div>
<div class="section" id="maccormack-method">
<h2><a class="toc-backref" href="#id5">15.3. MacCormack Method</a><a class="headerlink" href="#maccormack-method" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><strong>Step 1</strong> - uses FD scheme in x - call <span class="math">\(u^*\)</span> the temporary solution</li>
</ul>
<div class="math">
\[{{u_i^* - u_i^n} \over {\Delta t}} = -c {{{(u_{i+1}^n - u_i^n)}} \over {\Delta x}}\]</div>
<ul class="simple">
<li><strong>Step 2</strong> - uses BD scheme in x with <span class="math">\({{\Delta t} \over 2}\)</span></li>
</ul>
<div class="math">
\[{{u_i^{n+1} - u_i^{n+{1 \over 2}} } \over {{\Delta t} \over 2}}
= -c{{({u_{i}^* - u_{i-1}^*})} \over {\Delta x}}\]</div>
<p><strong>and</strong> replace the value <span class="math">\(u_i^{n+{1 \over 2}}\)</span> by the average</p>
<div class="math">
\[{u_i^{n + {1 \over 2}}} = {1 \over 2}(u_i^n + u_i^*)\]</div>
<ul class="simple">
<li><strong>Predictor</strong></li>
</ul>
<div class="math">
\[u_i^* = u_i^n - {{c \Delta t} \over {\Delta x}} (u_{i+1}^n - u_i^n)\]</div>
<ul class="simple">
<li><strong>Corrector</strong></li>
</ul>
<div class="math">
\[u_i^{n+1} = {1 \over 2} \left [ (u_i^n + u_i^*) - {{c \Delta t} \over {\Delta x}} (u_i^* - u_{i-1}^*)  \right ]\]</div>
<ul class="simple">
<li>2nd order method</li>
<li>Stability <span class="math">\(\sigma &lt; 1\)</span></li>
<li>For linear PDEs equivalent to LW</li>
<li>Can alternate FD/BD - BD/FD works well for <strong>nonlinear</strong> problems</li>
<li>Don&#8217;t need to store values at intermediate mesh points (like 2 step Lax Wendroff)</li>
</ul>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/MacCormack_scheme.png"><img alt="_images/MacCormack_scheme.png" src="_images/MacCormack_scheme.png" style="width: 800.0px; height: 700.0px;" /></a>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="new_convection_schemes.html">14. New Schemes for Convection</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="linear_convection.html">1. 1D First-order Linear Convection - The Wave Equation</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2014, Andrew Roberts.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>