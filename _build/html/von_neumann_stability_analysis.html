

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>12. von Neumann Stability Analysis &mdash; The Visual Room</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="The Visual Room" href="index.html" />
    <link rel="next" title="1. 1D First-order Linear Convection - The Wave Equation" href="linear_convection.html" />
    <link rel="prev" title="11. Analysis of Numerical Schemes" href="analysis_of_numerical_schemes.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>The Visual Room</span></a></h1>
        <h2 class="heading"><span>12. von Neumann Stability Analysis</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="analysis_of_numerical_schemes.html">11. Analysis of Numerical Schemes</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="linear_convection.html">1. 1D First-order Linear Convection - The Wave Equation</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="von-neumann-stability-analysis">
<h1>12. von Neumann Stability Analysis<a class="headerlink" href="#von-neumann-stability-analysis" title="Permalink to this headline">¶</a></h1>
<p>The key to the von Neumann stability analysis is to <strong>expand the solution (or error) in a finite Fourier series</strong></p>
<div class="section" id="fourier-decomposition-of-the-solution">
<h2>12.1. Fourier decomposition of the solution<a class="headerlink" href="#fourier-decomposition-of-the-solution" title="Permalink to this headline">¶</a></h2>
<p><span class="math">\(\bar{u}_i^n \rightarrow\)</span> <strong>exact</strong> solution of the discretised equations</p>
<p><span class="math">\(u_i^n \rightarrow\)</span> <strong>numerical</strong> solution of the discretised equations (roundoff error, errors in I.C. etc)</p>
<p><span class="math">\(N \rightarrow\)</span> <strong>numerical scheme</strong></p>
<p><span class="math">\(D \rightarrow\)</span> <strong>differential equations</strong></p>
<div class="math">
\[u_i^n = \bar{u}_i^n+ \bar{\epsilon}_i^n\]</div>
<p>By definition <span class="math">\(\rightarrow N(\bar{u}_i^n) \equiv 0\)</span></p>
<p>Apply <span class="math">\(N()\)</span> to equation above</p>
<div class="math">
\[N(u_i^n) = N(\bar{u}_i^n + \bar{\epsilon}_i^n)\]</div>
<p>If the Numerical scheme is <strong>linear</strong></p>
<div class="math">
\[N(u_i^n) = N(\bar{u}_i^n) + N(\bar{\epsilon}_i^n)\]\[N(u_i^n) = N(\bar{\epsilon}_i^n)\]</div>
<ul class="simple">
<li>If <span class="math">\(N(u_i^n)=0\)</span> represents the numerical scheme</li>
<li>Then the <strong>errors</strong> satisfy the same equation as the numerical solution, i.e.  <span class="math">\(N(\bar{\epsilon}_i^n)=0\)</span></li>
</ul>
</div>
<div class="section" id="wavenumbers-resolvable-by-a-domain">
<h2>12.2. Wavenumbers resolvable by a domain<a class="headerlink" href="#wavenumbers-resolvable-by-a-domain" title="Permalink to this headline">¶</a></h2>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/wavenumbers.png"><img alt="_images/wavenumbers.png" src="_images/wavenumbers.png" style="width: 600.0px; height: 187.5px;" /></a>
</div>
<ul class="simple">
<li>Consider a 1D domain <span class="math">\((0, L)\)</span></li>
<li>Reflect it onto <span class="math">\((-L, 0)\)</span></li>
<li>Create mesh point, spacing <span class="math">\(\Delta x\)</span></li>
</ul>
<div class="section" id="maximum-wavenumber">
<h3>12.2.1. Maximum wavenumber<a class="headerlink" href="#maximum-wavenumber" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>Shortest resolvable wavelength</strong> <span class="math">\(\lambda_{min} = 2 \Delta x\)</span></li>
<li><strong>Maximum wavenumber</strong> <span class="math">\(k_{max} = {{2 \pi} \over {2 \Delta x}} = {\pi \over {\Delta x}}\)</span></li>
</ul>
</div>
<div class="section" id="minimum-wavenumber">
<h3>12.2.2. Minimum wavenumber<a class="headerlink" href="#minimum-wavenumber" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>Largest resolvable wavelength</strong> <span class="math">\(\lambda_{max} = 2 L\)</span></li>
<li><strong>Minimum wavenumber</strong> <span class="math">\(k_{min} = {{2 \pi} \over {2 L}} = {\pi \over {L}}\)</span></li>
</ul>
</div>
</div>
<div class="section" id="harmonics">
<h2>12.3. Harmonics<a class="headerlink" href="#harmonics" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Mesh index <span class="math">\(i = 0 .... N\)</span>, <span class="math">\(x_i = i \Delta x\)</span>, <span class="math">\(\Delta x = {L \over N}\)</span></li>
<li>All harmonics represented in this finite mesh are:</li>
</ul>
<div class="math">
\[k_j = j k_{min} = j {\pi \over L} = j {\pi \over {N \Delta x}}\]</div>
<ul class="simple">
<li>Where: <span class="math">\(j = 0 .... N\)</span> (and <span class="math">\(j = 0\)</span> for a constant solution)</li>
</ul>
</div>
<div class="section" id="phase-angle">
<h2>12.4. Phase angle<a class="headerlink" href="#phase-angle" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Phase angle is given by:</li>
</ul>
<div class="math">
\[\phi = k_j \Delta x = j {\pi \over N}\]</div>
<p>Covers the whole domain <span class="math">\((-\pi, \pi)\)</span> in steps <span class="math">\(\pi \over N\)</span></p>
</div>
<div class="section" id="decomposition-in-finite-fourier-series">
<h2>12.5. Decomposition in finite Fourier series<a class="headerlink" href="#decomposition-in-finite-fourier-series" title="Permalink to this headline">¶</a></h2>
<div class="math">
\[u_i^n = \sum_{j=-N}^N V_j^n e ^{I k_j x_i} = \sum_{j=-N}^N V_j^n e ^{I k_j i \Delta x} = \sum_{j=-N}^N V_j^n e ^{{I i j \pi} / N}\]</div>
<ul class="simple">
<li>Where <span class="math">\(I = \sqrt{-1}\)</span></li>
<li>And <span class="math">\(V_j^n\)</span> = amplitude of <span class="math">\(j^{th}\)</span> harmonic</li>
</ul>
</div>
<div class="section" id="von-neumann-stability-condition">
<h2>12.6. von Neumann Stability Condition<a class="headerlink" href="#von-neumann-stability-condition" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>The amplitude of any harmonic many not grow indefinitely in time (as <span class="math">\(n \rightarrow \infty\)</span>)</li>
<li>Amplification factor - This is a function of the scheme parameters and <span class="math">\(\phi\)</span> (not n):</li>
</ul>
<div class="math">
\[G = {V^{n+1} \over V^n}\]</div>
<ul class="simple">
<li>Stability condition:</li>
</ul>
<div class="math">
\[\left\vert G \right\vert \le 1\]\[\forall \phi_j = j {\pi \over N}\]\[j = -N, N\]</div>
</div>
<div class="section" id="example-1-explicit-fd-in-t-cd-in-x-for-1d-linear-convection">
<h2>12.7. Example 1: Explicit FD in t, CD in x for 1D linear convection<a class="headerlink" href="#example-1-explicit-fd-in-t-cd-in-x-for-1d-linear-convection" title="Permalink to this headline">¶</a></h2>
<p>FD in t, CD in x:</p>
<div class="math">
\[{{u_i^{n+1} - u_i^n} \over {\Delta t}} + {c \over {2 \Delta x}} ({u_{i+1}^n - u_{i-1}^n})=0\]</div>
<p>Transpose:</p>
<div class="math">
\[u_i^{n+1}= u_i^n - {\sigma \over 2} ({u_{i+1}^n - u_{i-1}^n})\]</div>
<ol class="loweralpha simple">
<li>Replace all terms of the form <span class="math">\(u_{i+m}^{n+k}\)</span> by <span class="math">\(V^{n+k}e^{I(i+m)\phi}\)</span></li>
</ol>
<div class="math">
\[V^{n+1}e^{Ii\phi} = V^ne^{Ii\phi} - {\sigma \over 2} \left(V^ne^{I(i+1)\phi} - V^ne^{I(i-1)\phi} \right)\]</div>
<ol class="loweralpha simple" start="2">
<li>Divide through by <span class="math">\(e^{Ii\phi}\)</span></li>
</ol>
<div class="math">
\[V^{n+1} = V^n \left(1 - {\sigma \over 2} \left(e^{I\phi} - e^{-I\phi} \right) \right)\]</div>
<ol class="loweralpha simple" start="3">
<li>Amplification factor - exp function is periodic with period <span class="math">\(2\pi I\)</span>, i.e. <span class="math">\(e^{a+bI}=e^a(cosb + Isinb)\)</span>:</li>
</ol>
<div class="math">
\[G = {{V^{n+1}} \over {V^n}} = 1-{\sigma \over 2} \left(2I sin \phi \right) = 1- \sigma I sin \phi\]</div>
<ol class="loweralpha simple" start="4">
<li>Stability requires that the &#8220;norm of G&#8221; be less than 1, i.e. &#8220;G&#8221; times &#8220;G conjugate&#8221; is less than 1:</li>
</ol>
<div class="math">
\[GG^* = 1+\sigma^2sin^2\phi \gt 1\]</div>
<p><strong>Hence FD in t, CD in x for 1D linear convection is unconditionally unstable</strong></p>
</div>
<div class="section" id="example-2-implicit-bd-in-t-cd-in-x-for-1d-linear-convection">
<h2>12.8. Example 2 - Implicit BD in t, CD in x for 1D linear convection<a class="headerlink" href="#example-2-implicit-bd-in-t-cd-in-x-for-1d-linear-convection" title="Permalink to this headline">¶</a></h2>
<p>BD in t, CD in x:</p>
<div class="math">
\[u_i^{n+1}= u_i^n - {\sigma \over 2} ({u_{i+1}^{n+1} - u_{i-1}^{n+1}})\]</div>
<div class="math">
\[V^{n+1}= V^n - V^{n+1} {\sigma \over 2} \left({e^{I\phi} - e^{-I\phi}}\right)\]</div>
<p>Amplification factor:</p>
<div class="math">
\[G = 1- {\sigma \over 2}G\left({e^{I\phi} - e^{-I\phi}}\right)\]</div>
<p>Re-arrange:</p>
<div class="math">
\[G = { 1 \over {1+I\sigma sin \phi}}\]</div>
<div class="math">
\[\left\vert G \right\vert^2 = G \cdot G^* = { 1 \over {1+\sigma^2 sin^2 \phi}} \le 1 \qquad \forall \phi\]</div>
<ul class="simple">
<li><strong>BD in t and CD in x for 1D linear convection is unconditionally stable</strong></li>
</ul>
</div>
<div class="section" id="example-3-explicit-fd-in-t-bd-in-x-upwind-for-1d-linear-convection">
<h2>12.9. Example 3 - Explicit FD in t, BD in x (upwind) for 1D linear convection<a class="headerlink" href="#example-3-explicit-fd-in-t-bd-in-x-upwind-for-1d-linear-convection" title="Permalink to this headline">¶</a></h2>
<p>FD in t, BD in x:</p>
<div class="math">
\[u_i^{n+1}= u_i^n - \sigma ({u_{i}^{n} - u_{i-1}^{n}})\]</div>
<div class="math">
\[G = {V^{n+1} \over V^n} = 1- \sigma \left(1 - e^{-I\phi} \right) = 1- \sigma + \sigma cos \phi - I \sigma sin\phi\]</div>
<p>Since <span class="math">\(1-cos A=2 sin^2(A/2)\)</span></p>
<div class="math">
\[G = 1- 2\sigma sin^2 \left({\phi \over 2}\right)-I \sigma sin \phi\]</div>
<p>Separate real and imaginary parts of <span class="math">\(G\)</span>, <span class="math">\(\xi\)</span>, <span class="math">\(\eta\)</span></p>
<div class="math">
\[\xi = Re(G) =  1- 2\sigma sin^2 \left({\phi \over 2}\right) = (1-\sigma)+\sigma cos \phi\]</div>
<div class="math">
\[\eta = Im(G) = -\sigma sin \phi\]</div>
<p>Parametric equations for G on complex plane (with <span class="math">\(\phi\)</span> as a parameter) <span class="math">\(\rightarrow\)</span> circle centred on the real axis at point <span class="math">\((1-\sigma)\)</span></p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/stability.png"><img alt="_images/stability.png" src="_images/stability.png" style="width: 637.5px; height: 487.5px;" /></a>
</div>
<p>On the complex plane, the stability condition is <span class="math">\(\left\vert G \right\vert \lt 1\)</span></p>
<p>The circle for <span class="math">\(G\)</span> should be <strong>inside</strong> the unit circle</p>
<p>Stable for <span class="math">\(0 \le \sigma \le 1\)</span></p>
<p><strong>Hence FD in t, BD in x for 1D linear convection is conditionally stable</strong></p>
</div>
<div class="section" id="example-4-implicit-bd-in-t-bd-in-x-for-1d-linear-convection">
<h2>12.10. Example 4 - Implicit BD in t, BD in x for 1D linear convection<a class="headerlink" href="#example-4-implicit-bd-in-t-bd-in-x-for-1d-linear-convection" title="Permalink to this headline">¶</a></h2>
<p>BD in t, BD in x:</p>
<div class="math">
\[u_i^{n+1}= u_i^n - \sigma ({u_{i}^{n+1} - u_{i-1}^{n+1}})\]</div>
<div class="math">
\[G = {1 \over {1+\sigma(1-e^{-I\phi}})}\]</div>
<p>Stability:</p>
<div class="math">
\[GG^* = {1 \over {(1-\sigma + \sigma cos \phi)^2+\sigma^2sin^2\phi}} \lt 1 \qquad \forall \phi\]</div>
<p><strong>Hence BD in t, BD in x is unconditionally stable</strong></p>
<p><strong>Pattern:</strong></p>
<p>Most <strong>explicit</strong> schemes are either:</p>
<ul class="simple">
<li>Unconditionally unstable</li>
<li>Conditionally stable</li>
</ul>
<p>Most <strong>implicit</strong> schemes are:</p>
<ul class="simple">
<li>Unconditionally stable</li>
</ul>
<p><strong>Explicit</strong> schemes are useless for practical work. However, <strong>implicit</strong> schemes require more work to solve.</p>
</div>
<div class="section" id="example-5-explicit-fd-in-t-cd-in-x-for-1d-diffusion">
<h2>12.11. Example 5 - Explicit FD in t, CD in x for 1D diffusion<a class="headerlink" href="#example-5-explicit-fd-in-t-cd-in-x-for-1d-diffusion" title="Permalink to this headline">¶</a></h2>
<div class="math">
\[{\partial u \over \partial t} = \nu {\partial^2 u \over \partial x^2}\]</div>
<p>FD in t, CD in x:</p>
<div class="math">
\[u_i^{n+1} = u_i^n + \nu {\Delta t \over \Delta x^2}(u_{i+1}^n -2u_i^n+ u_{i-1}^n)\]</div>
<div class="math">
\[u_i^{n+1} = u_i^n + \beta(u_{i+1}^n -2u_i^n+ u_{i-1}^n)\]</div>
<p>Amplification factor:</p>
<div class="math">
\[G = 1-4 \beta sin^2 \left(\phi \over 2 \right)\]</div>
<p>Stability condition: <span class="math">\(\left\vert 1-4 \beta sin^2 \left(\phi \over 2 \right) \right\vert \le 1\)</span></p>
<p>Satisfied for:</p>
<div class="math">
\[-1 \le 1-4 \beta sin^2 \left(\phi \over 2 \right) \le 1\]</div>
<p>Or:</p>
<div class="math">
\[0 \le \beta \le {1 \over 2}\]</div>
<p><strong>Hence BD in t, BD in x is conditionally stable for:</strong></p>
<p><span class="math">\(\nu \gt 0\)</span> (stability of the physical problem)</p>
<p>and</p>
<p><span class="math">\({\nu {\Delta t \over \Delta x^2}} \le {1 \over 2}\)</span> (conditional stability of the scheme)</p>
</div>
<div class="section" id="example-6-implicit-bd-in-t-cd-in-x-for-1d-diffusion">
<h2>12.12. Example 6 - Implicit BD in t, CD in x for 1D diffusion<a class="headerlink" href="#example-6-implicit-bd-in-t-cd-in-x-for-1d-diffusion" title="Permalink to this headline">¶</a></h2>
<div class="math">
\[{\partial u \over \partial t} = \nu {\partial^2 u \over \partial x^2}\]</div>
<p>BD in t, CD in x:</p>
<div class="math">
\[u_i^{n+1} = u_i^n + \nu {\Delta t \over \Delta x^2}(u_{i+1}^{n+1} -2u_i^{n+1}+ u_{i-1}^{n+1})\]</div>
<p>Transpose:</p>
<div class="math">
\[u_i^{n+1} = u_i^n + \beta(u_{i+1}^{n+1} -2u_i^{n+1}+ u_{i-1}^{n+1})\]</div>
<ol class="loweralpha simple">
<li>Replace all terms of the form <span class="math">\(u_{i+m}^{n+k}\)</span> by <span class="math">\(V^{n+k}e^{I(i+m)\phi}\)</span></li>
</ol>
<div class="math">
\[V^{n+1}e^{Ii\phi} = V^ne^{Ii\phi} + {\beta} \left(V^{n+1}e^{I(i+1)\phi}-
                                                  2V^{n+1}e^{Ii\phi}+
                                                  V^{n+1}e^{I(i-1)\phi} \right)\]</div>
<ol class="loweralpha simple" start="2">
<li>Divide through by <span class="math">\(e^{Ii\phi}\)</span></li>
</ol>
<div class="math">
\[V^{n+1} = V^n + \beta V^{n+1} (e^{I\phi} -2 + e^{-I\phi})\]</div>
<ol class="loweralpha simple" start="3">
<li>Amplification factor - exp function is periodic with period <span class="math">\(2\pi I\)</span>, i.e. <span class="math">\(e^{a+bI}=e^a(cosb + Isinb)\)</span>:</li>
</ol>
<div class="math">
\[G = {{V^{n+1}} \over {V^n}} = {1 \over {1-2\beta(cos\phi -1)} }\]</div>
<ol class="loweralpha simple" start="4">
<li>Stability requires that the magnitude of G is less than 1:</li>
</ol>
<div class="math">
\[cos \phi = 1 \qquad \left\vert G \right\vert = \left\vert {1 \over {1-2\beta} } \right\vert\]\[cos \phi = 0 \qquad \left\vert G \right\vert = \left\vert {1 \over {1+2\beta} } \right\vert\]\[cos \phi = -1 \qquad \left\vert G \right\vert = \left\vert {1 \over {1-4\beta} } \right\vert\]\[\beta \rightarrow \infty \qquad \left\vert G \right\vert \rightarrow 0\]\[\beta = 0 \qquad \left\vert G \right\vert = 1\]\[\beta \rightarrow -\infty \qquad \left\vert G \right\vert \rightarrow 0\]</div>
<div class="math">
\[\left\vert G \right\vert \le 1\]</div>
<p><strong>Hence BD in t, CD in x for 1D diffusion is unconditionally stable</strong></p>
</div>
<div class="section" id="summary">
<h2>12.13. Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Stability conditions place a limit on the time step for a given spatial step.</li>
<li>This has a physical interpretation - the solution progresses too rapidly in time - especially a problem for convection dominated flows and compressible flows at the speed of sound - if c is large <span class="math">\(\Delta t\)</span> must be small.</li>
<li>Implicit schemes have no limit on timestep. Implicit vs explicit is a debatable area for different applications.</li>
<li>For the diffusion equation, the explicit time step restriction here is not too severe. But numerical diffusion can be large, depending on <span class="math">\(\Delta x\)</span>.</li>
<li><strong>The stability of linear schemes is well understood. But we have also neglected boundaries.</strong></li>
</ul>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="analysis_of_numerical_schemes.html">11. Analysis of Numerical Schemes</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="linear_convection.html">1. 1D First-order Linear Convection - The Wave Equation</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2014, Andrew Roberts.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>