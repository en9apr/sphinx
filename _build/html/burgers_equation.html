

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. 1D Second-order Non-linear Convection-Diffusion - Burgers’ Equation &mdash; The Visual Room</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="The Visual Room" href="index.html" />
    <link rel="next" title="1. Drikakis (2003) “Advances in Turbulent Flow Computations”" href="drikakis.html" />
    <link rel="prev" title="3. 1D Second-order Linear Diffusion - The Heat Equation" href="diffusion.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>The Visual Room</span></a></h1>
        <h2 class="heading"><span>4. 1D Second-order Non-linear Convection-Diffusion - Burgers’ Equation</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="diffusion.html">3. 1D Second-order Linear Diffusion - The Heat Equation</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="drikakis.html">1. Drikakis (2003) &#8220;Advances in Turbulent Flow Computations&#8221;</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="d-second-order-non-linear-convection-diffusion-burgers-equation">
<h1>4. 1D Second-order Non-linear Convection-Diffusion - Burgers&#8217; Equation<a class="headerlink" href="#d-second-order-non-linear-convection-diffusion-burgers-equation" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#understand-the-problem" id="id1">Understand the Problem</a></li>
<li><a class="reference internal" href="#formulate-the-problem" id="id2">Formulate the Problem</a><ul>
<li><a class="reference internal" href="#input-data" id="id3">Input Data</a></li>
<li><a class="reference internal" href="#output-data" id="id4">Output Data</a></li>
<li><a class="reference internal" href="#verification" id="id5">Verification</a></li>
</ul>
</li>
<li><a class="reference internal" href="#design-algorithm-to-solve-problem" id="id6">Design Algorithm to Solve Problem</a><ul>
<li><a class="reference internal" href="#space-time-discretisation" id="id7">Space-time discretisation</a></li>
<li><a class="reference internal" href="#numerical-scheme" id="id8">Numerical scheme</a></li>
<li><a class="reference internal" href="#discrete-equation" id="id9">Discrete equation</a></li>
<li><a class="reference internal" href="#transpose" id="id10">Transpose</a></li>
<li><a class="reference internal" href="#pseudo-code" id="id11">Pseudo-code</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implement-algorithm-in-python" id="id12">Implement Algorithm in Python</a></li>
<li><a class="reference internal" href="#conclusions" id="id13">Conclusions</a><ul>
<li><a class="reference internal" href="#why-doesn-t-the-numerical-simulation-agree-with-the-analytical-solution-exactly" id="id14">Why doesn&#8217;t the numerical simulation agree with the analytical solution exactly?</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="understand-the-problem">
<h2><a class="toc-backref" href="#id1">4.1. Understand the Problem</a><a class="headerlink" href="#understand-the-problem" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>What is the profile for 1D convection-diffusion when the initial conditions are a saw tooth wave and the boundary conditions are periodic?</li>
<li>How does this compare with the analytical solution?</li>
<li>1D convection-diffusion is described as follows:</li>
</ul>
<div class="math">
\[{\partial u \over \partial t} + u {\partial u \over \partial x} = \nu {\partial^2 u \over \partial x^2}\]</div>
</div>
<div class="section" id="formulate-the-problem">
<h2><a class="toc-backref" href="#id2">4.2. Formulate the Problem</a><a class="headerlink" href="#formulate-the-problem" title="Permalink to this headline">¶</a></h2>
<div class="section" id="input-data">
<h3><a class="toc-backref" href="#id3">4.2.1. Input Data</a><a class="headerlink" href="#input-data" title="Permalink to this headline">¶</a></h3>
<p><strong>Constants</strong></p>
<ul class="simple">
<li><span class="math">\(nt\)</span> = 51 (number of temporal points)</li>
<li><span class="math">\(nx\)</span> = 21 (number of spatial points)</li>
<li><span class="math">\(tmax\)</span> = 0.5</li>
<li><span class="math">\(xmax = 2 \pi\)</span></li>
</ul>
<p>Different initial and boundary conditions to linear convection:</p>
<p><strong>Initial Conditions</strong></p>
<div class="math">
\[u_i^{n=0} = -2 \nu {{\partial \phi / \partial x} \over \phi} + 4\]</div>
<p>where:</p>
<div class="math">
\[\phi = exp \left ({{-x^2} \over {4 \nu}} \right ) + exp \left [ -(x-2 \pi)^2 \over {4 \nu} \right ]\]</div>
<div class="math">
\[{{\partial \phi} \over {\partial x}} =
-{{2x} \over {4 \nu}} exp \left ( {{-x^2} \over {4 \nu}} \right )
-{2(x-2 \pi) \over {4 \nu}} exp \left [ -(x-2 \pi)^2 \over {4 \nu} \right ]\]</div>
<div class="math">
\[=
-{{0.5x} \over {\nu}} exp \left ( {{-x^2} \over {4 \nu}} \right )
-{0.5(x-2 \pi) \over {\nu}} exp \left [ -(x-2 \pi)^2 \over {4 \nu} \right ]\]</div>
<p><strong>Boundary Conditions</strong></p>
<p>Periodic:</p>
<div class="math">
\[u_{i=0}^n = u_{i=imax}^n\]</div>
</div>
<div class="section" id="output-data">
<h3><a class="toc-backref" href="#id4">4.2.2. Output Data</a><a class="headerlink" href="#output-data" title="Permalink to this headline">¶</a></h3>
<p>For all <span class="math">\(x\)</span> and <span class="math">\(t\)</span>:</p>
<div class="math">
\[u(x,t)\]</div>
</div>
<div class="section" id="verification">
<h3><a class="toc-backref" href="#id5">4.2.3. Verification</a><a class="headerlink" href="#verification" title="Permalink to this headline">¶</a></h3>
<p><strong>Verify the output with the analytical solution</strong></p>
<div class="math">
\[u_i^n = -2 \nu {{\partial \phi / \partial x} \over \phi} + 4\]</div>
<div class="math">
\[\phi = exp \left ({{-(x-4t)^2} \over {4 \nu(t+1)}} \right ) + exp \left [ -(x-4t-2 \pi)^2 \over {4 \nu(t+1)} \right ]\]</div>
<div class="math">
\[{{\partial \phi} \over {\partial x}} =
-{{2(x-4t)} \over {4 \nu(t+1)}} exp \left ( {{-(x-4t)^2} \over {4 \nu(t+1)}} \right )
-{{2(x-4t-2 \pi)} \over {4 \nu(t+1)}} exp \left [{-(x-4t-2 \pi)^2} \over {4 \nu(t+1)} \right ]\]</div>
<div class="math">
\[=
-{{0.5(x-4t)} \over {\nu(t+1)}} exp \left ( {{-(x-4t)^2} \over {4 \nu(t+1)}} \right )
-{{0.5(x-4t-2 \pi)} \over {\nu(t+1)}} exp \left [{-(x-4t-2 \pi)^2} \over {4 \nu(t+1)} \right ]\]</div>
</div>
</div>
<div class="section" id="design-algorithm-to-solve-problem">
<h2><a class="toc-backref" href="#id6">4.3. Design Algorithm to Solve Problem</a><a class="headerlink" href="#design-algorithm-to-solve-problem" title="Permalink to this headline">¶</a></h2>
<div class="section" id="space-time-discretisation">
<h3><a class="toc-backref" href="#id7">4.3.1. Space-time discretisation</a><a class="headerlink" href="#space-time-discretisation" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><strong>FD for transient term</strong></li>
<li><strong>BD for convection term</strong></li>
<li><strong>CD for diffusion term</strong></li>
</ul>
</div>
<div class="section" id="numerical-scheme">
<h3><a class="toc-backref" href="#id8">4.3.2. Numerical scheme</a><a class="headerlink" href="#numerical-scheme" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>i <span class="math">\(\rightarrow\)</span> index of grid in x</li>
<li>n <span class="math">\(\rightarrow\)</span> index of grid in t</li>
</ul>
</div>
<div class="section" id="discrete-equation">
<h3><a class="toc-backref" href="#id9">4.3.3. Discrete equation</a><a class="headerlink" href="#discrete-equation" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[{{u_i^{n+1} - u_i^n} \over {\Delta t}} + u_i^n {{u_i^n - u_{i-1}^n} \over {\Delta x}} = \nu {{u_{i+1}^n -2u_i^n+ u_{i-1}^n} \over \Delta x^2}\]</div>
</div>
<div class="section" id="transpose">
<h3><a class="toc-backref" href="#id10">4.3.4. Transpose</a><a class="headerlink" href="#transpose" title="Permalink to this headline">¶</a></h3>
<div class="math">
\[u_i^{n+1} = u_i^n -  u_i^n {\Delta t \over \Delta x} {{(u_i^n - u_{i-1}^n)}} + \nu {\Delta t \over \Delta x^2}(u_{i+1}^n -2u_i^n+ u_{i-1}^n)\]</div>
</div>
<div class="section" id="pseudo-code">
<h3><a class="toc-backref" href="#id11">4.3.5. Pseudo-code</a><a class="headerlink" href="#pseudo-code" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><pre># Constants

  nt = 51
  tmax = 0.5
  dt =  tmax/(nt-1)
  nx =  21
  xmax = 2
  dx = xmax/(nx-1)
  viscosity = 0.1

# Range of i is between 0 and nx-1
# Range of n is between 0 and nt-1

# This allows the number of points to be nx and nt

# Periodic Boundary Conditions
# Create points outside computational domain and set them to their equivalent within the computational domain

  for i between 0 and nx-1
     x(i) = i*dx
     ipos(i) = i+1
     ineg(i) = i-1

# Set Periodicity
# i:     -1    0,  1,..  nx-2, nx-1, nx
# ipos:            start =&gt;    =&gt;    end
# ineg:  start =&gt;  =&gt;    end

  ipos(nx-1) = 0    i.e. nx = 0
  ineg(0) = nx-1    i.e. -1 = nx-1

# Initial Conditions
  for i between 0 and nx-1
     phi = exp( -x(i)^2/(4*vis) ) + exp( -(x(i)-2*pi)^2 / (4*vis) )

     dphi = -(0.5/vis)*exp( -(x^2) / (4*vis) ) -
            (0.5*(x-2*pi) / vis )*exp(-(x-2*pi)^2 / (4*vis) )

     u(i,0) = -2*vis(dphi/phi) + 4

# Analytical Solution (this loop is not time marching,
  and has no initial conditions, so runs the full range of n)

  for n between 0 and nt-1

     t = n*dt

     for i between 0 and nx-1
        phi = exp( -(x(i)-4*t)^2/(4*vis*(t+1)) ) + exp( -(x(i)-4*t-2*pi)^2/(4*vis*(t+1)) )

        dphi = -0.5*(x(i)-4*t)^2/(vis*(t+1))*exp( -(x(i)-4*t)^2/(4*vis*(t+1)) )
               -0.5*(x(i)-4*t-2*pi)^2/(vis*(t+1))*exp( -(x(i)-4*t-2*pi)^2/(4*vis*(t+1)) )

        u_analytical(i,n) = -2*vis(dphi/phi) + 4

# Numerical Computation (this loop is time marching, so stops one before the end)

  for n between 1 and nt-2
      for i between 0 and nx-1
          u(i,n+1) = u(i,n) - u(i,n)*(dt/dx)*(u(i,n)-u(ineg(i),n))+
                     viscosity*(dt/dx^2)*(u(ipos(i),n)-2*u(i,n)+u(ineg(i),n))</pre>
</div>
</div>
</div>
<div class="section" id="implement-algorithm-in-python">
<h2><a class="toc-backref" href="#id12">4.4. Implement Algorithm in Python</a><a class="headerlink" href="#implement-algorithm-in-python" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>Constants are shown with CAPITAL letters</li>
<li>Aliases are used for imported functions and constants to shorten formulae</li>
</ul>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">pi</span> <span class="k">as</span> <span class="n">PI</span>
<span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">exp</span> <span class="k">as</span> <span class="n">exp</span>



<span class="k">def</span> <span class="nf">analytical_solution</span><span class="p">(</span><span class="n">NT</span><span class="p">,</span> <span class="n">NX</span><span class="p">,</span> <span class="n">TMAX</span><span class="p">,</span> <span class="n">XMAX</span><span class="p">,</span> <span class="n">NU</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Returns the velocity field and distance for the analytical solution</span>
<span class="sd">   &quot;&quot;&quot;</span>

   <span class="c"># Increments</span>
   <span class="n">DT</span> <span class="o">=</span> <span class="n">TMAX</span><span class="o">/</span><span class="p">(</span><span class="n">NT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">DX</span> <span class="o">=</span> <span class="n">XMAX</span><span class="o">/</span><span class="p">(</span><span class="n">NX</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

   <span class="c"># Initialise data structures</span>
   <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
   <span class="n">u_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NX</span><span class="p">,</span><span class="n">NT</span><span class="p">))</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NX</span><span class="p">)</span>
   <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NT</span><span class="p">)</span>

   <span class="c"># Distance</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NX</span><span class="p">):</span>
       <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">DX</span>

   <span class="c"># Analytical Solution</span>
   <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NT</span><span class="p">):</span>
       <span class="n">t</span> <span class="o">=</span> <span class="n">n</span><span class="o">*</span><span class="n">DT</span>

       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NX</span><span class="p">):</span>
           <span class="n">phi</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">NU</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">NU</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span>

           <span class="n">dphi</span> <span class="o">=</span> <span class="p">(</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NU</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">NU</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span>
               <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">NU</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">t</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">NU</span><span class="o">*</span><span class="p">(</span><span class="n">t</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span> <span class="p">)</span> <span class="p">)</span>

           <span class="n">u_analytical</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">NU</span><span class="o">*</span><span class="p">(</span><span class="n">dphi</span><span class="o">/</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span>

   <span class="k">return</span> <span class="n">u_analytical</span><span class="p">,</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">convection_diffusion</span><span class="p">(</span><span class="n">NT</span><span class="p">,</span> <span class="n">NX</span><span class="p">,</span> <span class="n">TMAX</span><span class="p">,</span> <span class="n">XMAX</span><span class="p">,</span> <span class="n">NU</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Returns the velocity field and distance for 1D non-linear convection-diffusion</span>
<span class="sd">   &quot;&quot;&quot;</span>

   <span class="c"># Increments</span>
   <span class="n">DT</span> <span class="o">=</span> <span class="n">TMAX</span><span class="o">/</span><span class="p">(</span><span class="n">NT</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
   <span class="n">DX</span> <span class="o">=</span> <span class="n">XMAX</span><span class="o">/</span><span class="p">(</span><span class="n">NX</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>

   <span class="c"># Initialise data structures</span>
   <span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
   <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NX</span><span class="p">,</span><span class="n">NT</span><span class="p">))</span>
   <span class="n">u_analytical</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">NX</span><span class="p">,</span><span class="n">NT</span><span class="p">))</span>
   <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NX</span><span class="p">)</span>
   <span class="n">t</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NT</span><span class="p">)</span>
   <span class="n">ipos</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NX</span><span class="p">)</span>
   <span class="n">ineg</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">NX</span><span class="p">)</span>

   <span class="c"># Periodic boundary conditions</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NX</span><span class="p">):</span>
       <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">*</span><span class="n">DX</span>
       <span class="n">ipos</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span>
       <span class="n">ineg</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span>

   <span class="n">ipos</span><span class="p">[</span><span class="n">NX</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
   <span class="n">ineg</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">NX</span><span class="o">-</span><span class="mi">1</span>

   <span class="c"># Initial conditions</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NX</span><span class="p">):</span>
       <span class="n">phi</span> <span class="o">=</span> <span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">NU</span><span class="p">)</span> <span class="p">)</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">NU</span><span class="p">)</span> <span class="p">)</span>
       <span class="n">dphi</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">NU</span><span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span> <span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">NU</span><span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">)</span> <span class="o">/</span> <span class="n">NU</span> <span class="p">)</span><span class="o">*</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">PI</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">NU</span><span class="p">)</span> <span class="p">)</span>
       <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">NU</span><span class="o">*</span><span class="p">(</span><span class="n">dphi</span><span class="o">/</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="mi">4</span>

   <span class="c"># Numerical solution</span>
   <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NT</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
       <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NX</span><span class="p">):</span>
           <span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">]</span><span class="o">*</span><span class="p">(</span><span class="n">DT</span><span class="o">/</span><span class="n">DX</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="n">u</span><span class="p">[</span><span class="n">ineg</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">n</span><span class="p">])</span><span class="o">+</span>
                      <span class="n">NU</span><span class="o">*</span><span class="p">(</span><span class="n">DT</span><span class="o">/</span><span class="n">DX</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">u</span><span class="p">[</span><span class="n">ipos</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">n</span><span class="p">]</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">n</span><span class="p">]</span><span class="o">+</span><span class="n">u</span><span class="p">[</span><span class="n">ineg</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">n</span><span class="p">]))</span>

   <span class="k">return</span> <span class="n">u</span><span class="p">,</span> <span class="n">x</span>

<span class="k">def</span> <span class="nf">plot_diffusion</span><span class="p">(</span><span class="n">u_analytical</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">NT</span><span class="p">,</span><span class="n">TITLE</span><span class="p">):</span>
   <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">   Plots the 1D velocity field</span>
<span class="sd">   &quot;&quot;&quot;</span>

   <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
   <span class="kn">import</span> <span class="nn">matplotlib.cm</span> <span class="kn">as</span> <span class="nn">cm</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
   <span class="n">ax</span><span class="o">=</span><span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
   <span class="n">colour</span><span class="o">=</span><span class="nb">iter</span><span class="p">(</span><span class="n">cm</span><span class="o">.</span><span class="n">rainbow</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">20</span><span class="p">,</span><span class="n">NT</span><span class="p">)))</span>
   <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">NT</span><span class="p">,</span><span class="mi">20</span><span class="p">):</span>
      <span class="n">c</span><span class="o">=</span><span class="nb">next</span><span class="p">(</span><span class="n">colour</span><span class="p">)</span>
      <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span><span class="s">&#39;ko&#39;</span><span class="p">,</span> <span class="n">markerfacecolor</span><span class="o">=</span><span class="s">&#39;none&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s">&#39;i=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="s">&#39; numerical&#39;</span><span class="p">)</span>
      <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">u_analytical</span><span class="p">[:,</span><span class="n">n</span><span class="p">],</span><span class="n">linestyle</span><span class="o">=</span><span class="s">&#39;-&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="n">c</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;i=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="s">&#39; analytical&#39;</span><span class="p">)</span>
   <span class="n">box</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
   <span class="n">ax</span><span class="o">.</span><span class="n">set_position</span><span class="p">([</span><span class="n">box</span><span class="o">.</span><span class="n">x0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span> <span class="n">box</span><span class="o">.</span><span class="n">width</span><span class="o">*</span><span class="mf">0.7</span><span class="p">,</span><span class="n">box</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
   <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mf">1.02</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s">&#39;x (radians)&#39;</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s">&#39;u (m/s)&#39;</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">8.0</span><span class="p">])</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">2.0</span><span class="o">*</span><span class="n">PI</span><span class="p">])</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">TITLE</span><span class="p">)</span>
   <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//burgers_equation-1.py">Source code</a>)</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">u</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">convection_diffusion</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">PI</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">u_analytical</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">analytical_solution</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">PI</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">plot_diffusion</span><span class="p">(</span><span class="n">u_analytical</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="s">&#39;Figure 1: nu=0.1, nt=151, nx=151, tmax=0.5s&#39;</span><span class="p">)</span>

<span class="n">u</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">convection_diffusion</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">PI</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">u_analytical</span><span class="p">,</span><span class="n">x</span> <span class="o">=</span> <span class="n">analytical_solution</span><span class="p">(</span><span class="mi">151</span><span class="p">,</span> <span class="mi">151</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">PI</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">plot_diffusion</span><span class="p">(</span><span class="n">u_analytical</span><span class="p">,</span><span class="n">u</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="s">&#39;Figure 2: nu=0.01, nt=151, nx=151, tmax=0.5s&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="figure">
<img alt="_images/burgers_equation-1_01_00.png" src="_images/burgers_equation-1_01_00.png" />
<p class="caption">(<a class="reference external" href=".//burgers_equation-1_01_00.png">png</a>, <a class="reference external" href=".//burgers_equation-1_01_00.hires.png">hires.png</a>, <a class="reference external" href=".//burgers_equation-1_01_00.pdf">pdf</a>)</p>
</div>
<div class="figure">
<img alt="_images/burgers_equation-1_01_01.png" src="_images/burgers_equation-1_01_01.png" />
<p class="caption">(<a class="reference external" href=".//burgers_equation-1_01_01.png">png</a>, <a class="reference external" href=".//burgers_equation-1_01_01.hires.png">hires.png</a>, <a class="reference external" href=".//burgers_equation-1_01_01.pdf">pdf</a>)</p>
</div>
</div>
<div class="section" id="conclusions">
<h2><a class="toc-backref" href="#id13">4.5. Conclusions</a><a class="headerlink" href="#conclusions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="why-doesn-t-the-numerical-simulation-agree-with-the-analytical-solution-exactly">
<h3><a class="toc-backref" href="#id14">4.5.1. Why doesn&#8217;t the numerical simulation agree with the analytical solution exactly?</a><a class="headerlink" href="#why-doesn-t-the-numerical-simulation-agree-with-the-analytical-solution-exactly" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>The numerical solution shows more dissipation through time and space than the analytical solution, despite the fact that the viscosity is the same in both cases (a lot in time, perhaps less in space)</li>
<li>It is likely that <strong>numerical dissipation</strong> is the cause of the difference between the analytic and numerical solutions</li>
<li>When physical viscosity is reduced, so reducing physical dissipation, the effect of numerical dissipation is seen more clearly (compare Figure 1 and Figure 2)</li>
<li>This is caused by the truncation error in the discretisation of the governing equations</li>
<li>The first order approximations for the transient and convection terms contain numerical diffusion in time and space respectively - probably need to use a higher than first order method for the transient term at least.</li>
</ul>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="diffusion.html">3. 1D Second-order Linear Diffusion - The Heat Equation</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="drikakis.html">1. Drikakis (2003) &#8220;Advances in Turbulent Flow Computations&#8221;</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2014, Andrew Roberts.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>