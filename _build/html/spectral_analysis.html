

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. Spectral Analysis of Errors &mdash; The Visual Room</title>
    
    <link rel="stylesheet" href="_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/print.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/theme_extras.js"></script>
    <link rel="top" title="The Visual Room" href="index.html" />
    <link rel="next" title="1. 1D First-order Linear Convection - The Wave Equation" href="linear_convection.html" />
    <link rel="prev" title="3. Conservative Form" href="conservative_form.html" /> 
  </head>
  <body>
      <div class="header"><h1 class="heading"><a href="index.html">
          <span>The Visual Room</span></a></h1>
        <h2 class="heading"><span>4. Spectral Analysis of Errors</span></h2>
      </div>
      <div class="topnav">
      
        <p>
        «&#160;&#160;<a href="conservative_form.html">3. Conservative Form</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="linear_convection.html">1. 1D First-order Linear Convection - The Wave Equation</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="spectral-analysis-of-errors">
<h1>4. Spectral Analysis of Errors<a class="headerlink" href="#spectral-analysis-of-errors" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#von-neumann-stability-analysis" id="id3">von Neumann Stability Analysis</a></li>
<li><a class="reference internal" href="#amplitude-and-phase-error" id="id4">Amplitude and Phase Error</a><ul>
<li><a class="reference internal" href="#analytical-solution" id="id5">Analytical Solution</a></li>
<li><a class="reference internal" href="#numerical-solution" id="id6">Numerical Solution</a></li>
<li><a class="reference internal" href="#diffusion-and-dispersion-error" id="id7">Diffusion and Dispersion Error</a></li>
</ul>
</li>
<li><a class="reference internal" href="#error-analysis-for-hyperbolic-problems" id="id8">Error Analysis for Hyperbolic Problems</a><ul>
<li><a class="reference internal" href="#governing-equation" id="id9">Governing Equation</a></li>
<li><a class="reference internal" href="#id1" id="id10">Analytical Solution</a></li>
<li><a class="reference internal" href="#id2" id="id11">Numerical Solution</a></li>
<li><a class="reference internal" href="#leading-and-trailing-error" id="id12">Leading and Trailing Error</a></li>
<li><a class="reference internal" href="#accuracy-and-stability-paradox" id="id13">Accuracy and Stability Paradox</a></li>
</ul>
</li>
<li><a class="reference internal" href="#analysis-of-1st-order-upwind" id="id14">Analysis of 1st Order Upwind</a><ul>
<li><a class="reference internal" href="#dispersion-phase-error-for-1st-order-upwind" id="id15">Dispersion (Phase) Error for 1st Order Upwind</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="von-neumann-stability-analysis">
<h2><a class="toc-backref" href="#id3">4.1. von Neumann Stability Analysis</a><a class="headerlink" href="#von-neumann-stability-analysis" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li>von Neumann stability analysis introduced a Fourier decomposition of the solution, defining an amplification factor, <cite>G</cite>, <span class="math">\(\Rightarrow\)</span> stability condition <cite>G &lt; 1</cite></li>
<li>What else can we know about the errors?</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>Amplitude error <span class="math">\(\Rightarrow\)</span> numerical diffusion</li>
<li>Phase error <span class="math">\(\Rightarrow\)</span> numerical dispersion</li>
</ul>
</div></blockquote>
<p>We introduced a Fourier decomposision of the solution (where <span class="math">\(I = \sqrt{-1}\)</span>):</p>
<div class="math">
\[u_i^n = \sum_{j=-N}^N V_j^n e^{Ik_j x_i} \qquad x_i = i \Delta x\]</div>
<p>A single harmonic is:</p>
<div class="math">
\[(u_i^n)_k = V^n e^{I k i \Delta x}\]</div>
<p>We define an amplification factor:</p>
<div class="math">
\[G = {{V^{n+1}} \over {V^n}}\]</div>
<p>A function of the scheme parameters and of the phase angle <span class="math">\(\phi\)</span> but not a function of <span class="math">\(n\)</span></p>
<p>von Neumann stability condition:</p>
<div class="math">
\[\left| G \right| \le 1 \qquad \forall \phi_j = k_j \Delta x\]</div>
</div>
<div class="section" id="amplitude-and-phase-error">
<h2><a class="toc-backref" href="#id4">4.2. Amplitude and Phase Error</a><a class="headerlink" href="#amplitude-and-phase-error" title="Permalink to this headline">¶</a></h2>
<p>Now we want additional information on the error, in particular the time dependency of the:</p>
<ul class="simple">
<li>Amplitude <span class="math">\(V^n\)</span></li>
<li>Phase <span class="math">\(\phi\)</span></li>
</ul>
<div class="section" id="analytical-solution">
<h3><a class="toc-backref" href="#id5">4.2.1. Analytical Solution</a><a class="headerlink" href="#analytical-solution" title="Permalink to this headline">¶</a></h3>
<p>Consider the analytical solution of:</p>
<div class="math">
\[u_t + cu_x = 0\]</div>
<p>Fourier decomposition - analytical solution is <span class="math">\(\tilde{u}\)</span>:</p>
<div class="math">
\[\tilde{u}_i^n = \hat{V} e^{Ik(x_i-ct^n)}\]</div>
<p>Rewrite with <span class="math">\(c = {{\tilde{\omega}} / k}\)</span>:</p>
<div class="math">
\[\tilde{u}_i^n = \hat{V} e^{I k x_i} e^{-I \tilde{\omega} t^n}\]</div>
<p>A single harmonic is:</p>
<div class="math" id="equation-analytical">
<span class="eqno">(1)</span>\[(\tilde{u}_i^n)_k = \hat{V}(k) e^{I k x_i} e^{-I \tilde{\omega} t^n}\]</div>
<p>With <span class="math">\(\hat{V}(k)\)</span> from the initial condition <span class="math">\(u(x,t=0) = u_0(x)\)</span> we get an initial amplitude:</p>
<div class="math">
\[\hat{V}(k) = {1 \over {2L}} \int_{-L}^L u_0(x)e^{-Ikx} dx\]</div>
<p>Assume that I.C. is represented exactly on the mesh (except for round-off error)</p>
</div>
<div class="section" id="numerical-solution">
<h3><a class="toc-backref" href="#id6">4.2.2. Numerical Solution</a><a class="headerlink" href="#numerical-solution" title="Permalink to this headline">¶</a></h3>
<p>Numerical amplitude represented similarly to <a href="#equation-analytical">(1)</a> (<span class="math">\(\omega\)</span> is analytical):</p>
<div class="math">
\[V^n = \hat{V}(k) e^{-I \omega n \Delta t} = \hat{V}(k) (e^{-I \omega \Delta t})^n\]</div>
<p>Phase waves <span class="math">\(\tilde{\omega} = \tilde{\omega}(k) \Rightarrow\)</span> called a &#8220;dispersion relation&#8221;</p>
<p>Now write:</p>
<div class="math">
\[V^n = G V^{n-1} = G^2 V^{n-2} = ... = G^n V^0 = G^n \hat{V}(k)\]</div>
<p>Hence:</p>
<div class="math">
\[G = e^{-I \omega \Delta t} \Rightarrow \qquad \text{this defines} \qquad \omega(k)\]</div>
<p>Similarly with the analytical solution:</p>
<div class="math">
\[\hat{V}^n = ({e^{-I \tilde{\omega} \Delta t}})^n \hat{V}(k) = (\tilde{G})^n \hat{V}(k)\]</div>
<p>Where: <span class="math">\(\tilde{G}\)</span> is the exact amplification factor</p>
<p>Note that <span class="math">\(\omega\)</span> is a complex function, so:</p>
<div class="math">
\[G = \left| G \right| e^{-I \phi}\]</div>
<p>And</p>
<div class="math">
\[V^n = GV^{n-1} = \left| G \right| e^{-I \phi} V^{n-1}\]</div>
</div>
<div class="section" id="diffusion-and-dispersion-error">
<h3><a class="toc-backref" href="#id7">4.2.3. Diffusion and Dispersion Error</a><a class="headerlink" href="#diffusion-and-dispersion-error" title="Permalink to this headline">¶</a></h3>
<p>For convection dominated flows <span class="math">\(\tilde{\phi} = kc \Delta t\)</span> and <span class="math">\(\left | \tilde{G} \right | = 1\)</span>:</p>
<p><strong>The error in amplitude is the diffusion or dissipation error:</strong></p>
<div class="math">
\[\epsilon_D = {{\left| G \right|} \over {\left| \tilde{G} \right|}}\]</div>
<p><strong>The error in the phase of the solution is the dispersion error:</strong></p>
<div class="math">
\[\epsilon_\phi = {{\phi} \over {\tilde{\phi}}}\]</div>
<p>For pure diffusion <span class="math">\(\tilde{\phi} = 0\)</span> so therefore use the alternative definition:</p>
<div class="math">
\[\epsilon_\phi = {\phi} - {\tilde{\phi}}\]</div>
</div>
</div>
<div class="section" id="error-analysis-for-hyperbolic-problems">
<h2><a class="toc-backref" href="#id8">4.3. Error Analysis for Hyperbolic Problems</a><a class="headerlink" href="#error-analysis-for-hyperbolic-problems" title="Permalink to this headline">¶</a></h2>
<p>Considering 1D linear convection, we will define:</p>
<ul class="simple">
<li>Leading error as numerical convection is faster than physical</li>
<li>Lagging error as numerical convection is slower than physical</li>
</ul>
<p>We will also analyse the 1st-order upwind scheme</p>
<div class="section" id="governing-equation">
<h3><a class="toc-backref" href="#id9">4.3.1. Governing Equation</a><a class="headerlink" href="#governing-equation" title="Permalink to this headline">¶</a></h3>
<p>Consider the solution of:</p>
<div class="math">
\[u_t + cu_x = 0\]</div>
</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id10">4.3.2. Analytical Solution</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>The exact solution for a wave form: <span class="math">\(\tilde{\omega} = ct\)</span></p>
<p>And:</p>
<div class="math">
\[\tilde{u} =  \hat{V} e^{Ikx} e^{-Ikct}\]</div>
<p>Exact amplification factor <span class="math">\(\left | \tilde{G} \right | = 1\)</span> and</p>
<div class="math">
\[\tilde{\phi} = ck \Delta t = {{c \Delta t} \over {\Delta x}}.k \Delta x = \sigma \phi\]</div>
<p>Therefore</p>
<div class="math">
\[\tilde{G} = e^{-I \sigma \phi}\]</div>
<p>i.e. <strong>the exact solution propagates without change in amplitude</strong> For example, the exact solution of the wave equation with square wave input simply moves to the right with positive c</p>
</div>
<div class="section" id="id2">
<h3><a class="toc-backref" href="#id11">4.3.3. Numerical Solution</a><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Initial wave damped by a factor <span class="math">\(\left| G \right|\)</span> at each <span class="math">\(\Delta t\)</span></p>
<p>Diffusion error is <span class="math">\(\epsilon_D = \left| G \right|\)</span></p>
<p>Phase of numerical solution defines a <strong>numerical</strong> convection speed:</p>
<div class="math">
\[c_{num} = {\Phi \over {k \Delta t}}\]</div>
<p>And since:</p>
<div class="math">
\[\tilde{\phi} = ck \Delta t = \sigma \phi\]</div>
<div class="math">
\[c_{num} = {{c \Phi} \over {\sigma \phi}}\]</div>
<p>Dispersion error:</p>
<div class="math">
\[{\epsilon_\phi} = {\Phi \over {c k \Delta t}} = {\Phi \over {\sigma \phi}} = {c_{num} \over c}\]</div>
</div>
<div class="section" id="leading-and-trailing-error">
<h3><a class="toc-backref" href="#id12">4.3.4. Leading and Trailing Error</a><a class="headerlink" href="#leading-and-trailing-error" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>When the dispersion error is larger than 1 <span class="math">\(\epsilon_\phi \gt 1\)</span> the phase error is a &#8220;leading error&#8221;, the numerical convection speed <span class="math">\(c_{num}\)</span> is larger than the exact <span class="math">\(c\)</span>. The computed solution moves faster than the physical one.</li>
<li>When <span class="math">\(\epsilon_{\phi} \lt 1\)</span> the phase error is a lagging error and the computed solution travels at a lower velocity than the physical one.</li>
</ul>
</div>
<div class="section" id="accuracy-and-stability-paradox">
<h3><a class="toc-backref" href="#id13">4.3.5. Accuracy and Stability Paradox</a><a class="headerlink" href="#accuracy-and-stability-paradox" title="Permalink to this headline">¶</a></h3>
<p>Accuracy requires <span class="math">\(\left| G \right |\)</span> to be as close to 1 as possible, but stability requires <span class="math">\(\left | G \right | \lt 1\)</span>.</p>
<p>To maintain stability we always need a diffusion error.</p>
</div>
</div>
<div class="section" id="analysis-of-1st-order-upwind">
<h2><a class="toc-backref" href="#id14">4.4. Analysis of 1st Order Upwind</a><a class="headerlink" href="#analysis-of-1st-order-upwind" title="Permalink to this headline">¶</a></h2>
<p>We found:</p>
<div class="math">
\[G = 1- 2\sigma sin^2 \left({\phi \over 2}\right)-I \sigma sin \phi\]</div>
<p>Separate real and imaginary parts of <span class="math">\(G\)</span>, <span class="math">\(\xi\)</span>, <span class="math">\(\eta\)</span></p>
<div class="math">
\[\xi = Re(G) =  1- 2\sigma sin^2 \left({\phi \over 2}\right) = (1-\sigma)+\sigma cos \phi\]</div>
<div class="math">
\[\eta = Im(G) = -\sigma sin \phi\]</div>
<p>Amplitude error:</p>
<div class="math">
\[\epsilon_D = \sqrt{Im^2 + Re^2}= \left| G \right| = (1-4 \sigma(1-\sigma)sin^2 ({\phi \over 2}))^{0.5}\]</div>
<p>Phase error:</p>
<div class="math">
\[tan \Phi = -{Im(G) \over Re(G)}\]</div>
<div class="math">
\[\epsilon_{\phi} =  {\Phi \over {\sigma \phi}} = {{tan^{-1}[( \sigma sin \phi ) / (1-\sigma + \sigma cos \phi )]} \over { \sigma \phi  }}\]</div>
<div class="section" id="dispersion-phase-error-for-1st-order-upwind">
<h3><a class="toc-backref" href="#id15">4.4.1. Dispersion (Phase) Error for 1st Order Upwind</a><a class="headerlink" href="#dispersion-phase-error-for-1st-order-upwind" title="Permalink to this headline">¶</a></h3>
<div class="figure align-center">
<img alt="_images/UD_dispersion.png" src="_images/UD_dispersion.png" />
</div>
<div class="figure align-center">
<img alt="_images/UD_diffusion.png" src="_images/UD_diffusion.png" />
</div>
<div class="figure align-center">
<img alt="_images/LF_dispersion.png" src="_images/LF_dispersion.png" />
</div>
<div class="figure align-center">
<img alt="_images/LF_diffusion.png" src="_images/LF_diffusion.png" />
</div>
<div class="figure align-center">
<img alt="_images/LW_dispersion.png" src="_images/LW_dispersion.png" />
</div>
<div class="figure align-center">
<img alt="_images/LW_diffusion.png" src="_images/LW_diffusion.png" />
</div>
<div class="figure align-center">
<img alt="_images/Leapfrog_dispersion.png" src="_images/Leapfrog_dispersion.png" />
</div>
<div class="figure align-center">
<img alt="_images/BW_dispersion.png" src="_images/BW_dispersion.png" />
</div>
<div class="figure align-center">
<img alt="_images/BW_diffusion.png" src="_images/BW_diffusion.png" />
</div>
</div>
</div>
</div>


      </div>
      <div class="bottomnav">
      
        <p>
        «&#160;&#160;<a href="conservative_form.html">3. Conservative Form</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="linear_convection.html">1. 1D First-order Linear Convection - The Wave Equation</a>&#160;&#160;»
        </p>

      </div>

    <div class="footer">
        &copy; Copyright 2014, Andrew Roberts.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.3.
    </div>
  </body>
</html>