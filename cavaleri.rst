=====================================
Wave Modelling - the State of the Art
=====================================

Cavaleri et al. "Wave Modelling - the State of the Art", Progress in Oceanography, 75 (2007) pp 603 - 674

.. contents::
   :local:

SUMMARY
=======

We can evaluate the integral properties of the sea with good accuracy (significant wave height, period and direction). However, peaks and extreme conditions are frequently not well reproduced because:

* metrological input is not good enough
* physical assumptions become invalid

Physical Assumptions
--------------------

* For wind-wave generation waves are assumed to be a superposition of sinusoidal linear components - **linearity is invalid in a stormy sea with high skewness**. How to proceed is an open question.

* For the dissipation of wind-waves, there is currently no consensus on the physics of the spectral dissipation of wave energy due to wave breaking in theory or experiment. However, the next likely step is probably on the experimental side.

* For non-linear interactions in shallow water, we currently assume waves can be represented either by deterministic (phase-resolving) or stochastic (phase-averaging) models. However, future solutions may lie between these approaches. **Depth induced dissipation and how to distribute energy loss throughout the spectrum are both unknown, and these models often assume extremely simplistic bathymetrics.**

* For bottom dissipation, the true physical characteristics of the bottom are unknown (dimensions of ripples, sheet flow etc). However, the physics is fairly well known, except in the case of anelastic motion of viscous muddy bottoms which applies in the case of a hurricane. 

* For numerics the garden sprinkler effect can be countered with artificial diffusion. **Higher order advection schemes exist but no agreement exists on which is the most suitable**. Unstructured grids are gaining popularity. Semi-Lagrangian schemes may relax the stability/accuracy requirements of the Euler method, but using the same timestep for all frequencies may lead to suitable but articifial changes during each integration step. **Combining Eulerian and Lagrangian schemes may be a future possibility for open and coastal waters.**

What is really going on?
------------------------

* People are **"tuning"** their models for each individual process to fit the experimental data - using **white capping** as the "tuning knob"

What do we really need?
-----------------------

* Consider the real driving mechanism: **wind - waves - breaking - circulation** 
* Requiring interaction between the **atmospheric, wave and circulation** modelling communities.
* **More fundamental coupling between the sea and the atmosphere** - not via empirical formulations - but by sound physics

WIND-WAVE GENERATION
====================

The problem is to accurately model:

* the **growth** of ocean waves by wind.
* the consequent **feedback** of the ocean waves on the wind

Field observations in the 1970s and theoretical work on the critical layer in the 1950s led to:

* parameterisations of the wind-input source function 
* realistic representation of the high wave number part of the spectrum

Problems are:

* the high frequency variability in atmospheric models
* modelling extreme cases of low wind and high wind
* the drag coefficient may not be well specified in extreme situations, e.g. hurricanes.

Linear Theory
-------------

The Problem
~~~~~~~~~~~

* The theoretical problem is difficult because we are modelling a turbulent airflow over a surface that varies in space and time.
* The experimental problem is difficult because most instrumentation cannot directly measure the growth of waves by wind.

The History
~~~~~~~~~~~

* Jeffreys (1924) started by assuming that airflow over a wave was sheltered on it's lee side. This would give a pressure difference, so work was done by the wind. However, experiments on solid waves showed that this *pressure difference was too small to account for the growth rates*.
* Moved on to assume that **waves were generated by resonance**. Two approaches:

  - Miles (1957) "resonant interaction between pressure fluctuations and free surface waves"
  - Phillips (1957) "resonant forcing of surface waves by turbulent pressure flucuations"
* Miles (1957) **resonant interaction between pressure fluctuations and free surface waves** was more promising because it implies exponential growth and it is of the order of the density ratio of air and water.
* Problems with Miles:

  - used quasi-laminar approach - *airflow is inviscid* and *turbulence only maintains the shear flow*.
  - *neglected non-linear effects*, such as wave-mean flow interaction (which are important at the critical height where the phase speed and wind speed match)
  - Experiments by Dobson (1971) show rate of energy transfer is an order of magnitude higher than Miles predicts
  - Recent experiments show Miles underpredicts energy transfer for low frequency waves with a wind speed close to phase speed

* Solutions to Miles' problems, use **mixing length turbulence model**:

  - model turbulent boundary layer over a moving surface, using mixing length turbulence model for Reynolds stresses, for the effect of small scale turbulence on wave growth. This allows:

    + interaction of wave induced flow with mean flow
    + boundary layer turbulence

* What Miles didn't show is then shown:
  
  - diffusion of momentum is so large with turbulence included that Miles critical mechanism is ineffective
  - in adverse winds or when waves are propagating faster than wind speed, damping is present (Miles showed no damping). However no field observations show damping - presumably because damping time scales are quite long.

* Problem with mixing length turbulence model:

  - assumes *momentum transport caused by turbulence is the fastest process in the fluid* - not justified for low frequency waves, which interact with large eddies, whose eddy turnover time is larger than the wave period
  - *inadequate for slowly propagating waves*. Far away from the surface, turbulence is slow moving and doesn't have time to transfer momentum - causing truncation of the mixing length in the outer-layer. Energy transfer from wind to slow waves only occurs in a thin layer above the surface. The mechanism is non-separated sheltering - Reynolds stresses cause a thickening of the boundary layer on the leeside - This is similar to Jeffreys (1924)

* Use instead a **rapid distortion** approach:

  - critical layer mechanism is only relevant for very fast moving ocean waves

* Rapid distortion approach may overestimate the effect of eddies:

  - Use eddy resolving model, which shows a critical layer at a wide range of dimensionless phase speeds (but only done for low Re). A rapid fall off of the wave-induced stress was seen at the critical height. 
  - In-situ observation also shows a critical layer (where the wave-induced stress shows a jump), but only for dimensionless phase speeds > 16.
  - reason for the over-estimation of eddies by rapid distortion approach: *large eddies too slow to transport momentum* - outer layer is approximately inviscid and only a thin layer above the surface applies

* Instead of rapid distortion approach, use **truncated mixing length model with turbulent time scale**:

  - Turbulent timescale redifined to give a longer timescale than rapid distortion model
  - Mixing length truncated
  - Resulting growth rate is a function of the Miles critical layer effect and a small damping term caused by the inner layer viscosity. This is ok for short wavelengths, but *not for longer wavelengths*.


Nonlinear Effects
-----------------

The Problem
~~~~~~~~~~~
Quasi-laminar Miles theory is fairly good at predicting growth rate. However, it doesn't include non-linearity.

Sources of non-linearity:

* **In wind profile:** Possible change in wind profile as ocean waves are evolving - deviations from the turbulent profile due to a flat plate are expected - profile controlled by both turbulent and wave-induced momentum flux. Momentum transfer from wind to wave can be so large that the wave-induced stress is a substantial fraction of the turbulent stress.
* **In surface waves:** Energy transfer from air to waves is probably affected by the sea state. Probably have strong coupling between the surface wave and the atmospheric turbulent boundary layer.

Observation
~~~~~~~~~~~

* Measurement confirms that the **drag coefficient is dependent on the sea state**.
* Quasi-linear theory of wind-wave generation keeps track of the evolution of the sea state and it's effects on the wind profile and follows Miles theory.
* Parameterization of roughness length in terms of wave-induced stress shows fair agreement with observed roughness. Can determine at every timestep what the momentum transfer is from air to waves.

Wave age
~~~~~~~~

* Short waves are the fastest growing, so **wave induced stress is largly determined by the high frequency spectrum**. Also young windsea shows steeper short waves than old windsea. Nobody really know why this is. Four wave interactions and Stokes drift may be possible mechanisms. 

Linearity
~~~~~~~~~

* **Quasi-linear theory assumes short waves are linear**, but they are probably steep. Therefore the non-linear process of air separation similar to Jeffreys (1924) may play a role in air-sea momentum transfer. This may explain the dependence of drag coefficient in sea state.
* **Miles quasi-laminar theory assumed that each spectral component is linear**. Tsimring (1983) studied two wave components and mean airflow finding that the effect is proportional to the air-sea density ratio times the square of the wave spectrum.

Evidence in the field of sea state dependence on drag coefficient
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* **For windsea, it is possible to find a convincing parameterisation of sea state dependence of the surface stress**. The drag coefficient and dynamic roughness under mixed-sea conditions remain difficult to parameterise.

Gustiness
---------

Problem
~~~~~~~

In previous comments we have assumed airflow is constant, but it isn't. Wind varies with a timescale longer than the wind generated waves, but still below the resolution of meterological models and may affect wave growth.

Solutions
~~~~~~~~~

* It is common to assume energy transfer is a function of the nominal wind speed, U and the phase speed, c of the component. The wave growth is non-linear wrt U-c. 

  - For c > Um (mean value) there is no interaction between wind and waves. 
  - For c close to Um, a positive fluctuation in wind speed will result in enhanced wave growth, but a negative fluctuation will not give rise to reduced growth. Growing waves act as a recifier - the **diode effect**
  - How much they gain in wave height depends on the variability of the wind field (% rms deviation from Um).

* Gain in wave height also depends on correlation time scale of the fluctuating wind:

  - if the timescale of the gustiness <= integration timestep (or spatial step), growth curve will be smooth
  - if timescale of gustiness > integration timestep, growth curve will be oscillatory around mean growth curve 

**While there are good practical and theoretical reasons for considering gustiness, operational models don't consider it, because there isn't much information on gustiness of input wind fields and it complicates validation**


Open Issues
-----------

Damping of Low Frequency Swells
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* There is uncertainty regarding the damping rates of low frequency swells due to lack of field observations, because the timescales of these swells are quite long.

Momentum Transfer for High Wind Speeds
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* There is some debate over whether the drag coefficient within a hurricane or typhoon increases or decreases with wind speed. The reason for this is the lack of observations and there are many complex mechanisms occuring simultaneously, and they affect each other e.g.:

  - momentum
  - heat fluxes
  - spray 

Three reasons why drag might be reduced in a hurricane:

* Aerodynamic explanations of reduced drag in a hurricane follow the logic of the wind skipping over the crests, so the aerodynamic roughness is reduced. 
* Also as spray returns to the sea, it removes small waves (which hold the greatest wave induced stress) hence drag can be reduced in this way. 
* Also it is claimed that extremely young seas like in a hurricane would have reduced drag.

Argument using only spray:

* Spray may stay close to the surface, supressing turbulence, inhibiting momentum transfer to the sea - reducing drag
* Spray may be accelerated by the mean airflow - increasing drag 

Quality of Modelled Wind Fields
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* **At present no model of the atmospheric boundary layer can justify the level of wind variablity measured in the field in certain conditions**


BOTTOM DISSIPATION
==================

Problem
-------

In shallow water bottom dissipation is needed to complete the energy balance. The soruces of bottom dissipation are:

* Percolation into a porous medium
* Motion of a mobile bed
* Dissipation through turbulent bed shear stress, with an associated bottom boundary layer.

Wave energy dissipation due to bottom friction
----------------------------------------------

* Bottom friction can caused a few watts of energy loss per square metre, which is similar to moderate wind input.
* We need the shear stress and the orbital velocity for each wavenumber at the sea bed.
* Drag coefficient or friction coefficient or friction factor or equivalent roughness are needed
* Major problem is that it is difficult to measure bottom friction directly, because other processes such as atmospheric input, nonlinear interactions, whitecap dissipation, refraction and shoaling may also be present.

Common formulations for spectral wave models: waves and currents
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* The effect of the interaction between waves and currents on bottom stress is not completely solved - i.e. whether the interaction is weak or strong.

Bottom roughness model for movable beds
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* Hydraulic roughness is a combination of:

  - skin friction on individual grains
  - form drag due to bed forms

* Different experiments can produce different roughness values, by orders of magnitude, for large roughness elements or steep ripples, momentum transfer is dominated by vortex-shedding rather than random turbulence.

Energy dissipation due to wave-bottom interaction
-------------------------------------------------

As well as friction, energy is lost as:

* damping due to percolation in a permeable bed layer
* absorption of energy in a bottom layer of soft mud

Outstanding Problems
--------------------

Only way to make further progress on wave dissipation due to interaction with a movable or soft bottom is though a combined study of the wave field and its effect on sediment motion

But flow properties and sediment concentration close to the bottom and in the case of mud also visco-elastic properties of the bottom are difficult to measure. This is so in the lab, but even more so in the field.

SPECTRAL DISSIPATION IN DEEP WATER
==================================

Spectral wave energy dissipation is the least understood part of the physics in wave modelling. The mechanisms in order of contribution to this dissipation are:

* wave breaking
* interaction of waves with turbulence
* short wave modulation by long waves
* interaction of waves with the vertical structures of the upper layers of the ocean
* whitecapping

Studies can be separated in:

* wave physics
* numerics

Theoretical and experimental research of physics of the spectral dissipation
----------------------------------------------------------------------------

Three sources considered:

* wave breaking
* wave-turbulence interaction
* wave-wave modulation

Spectral dissipation due to wave breaking
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

Two main approaches for modelling spectral dissipation:

* prior to breaking
  
  - probability model
  - quasi-saturated model
 
* after wave breaking

  - weak in the mean model
  - effective turbulent viscosity **note: eddy viscosity approach is not generally accepted**
  - bubble model

Validation is needed:

  - radar
  - aerial images

What does breaking depend on? There are many theories:

  - balance of source terms - balance of wind generation and breaking dissipation
  - spectral dissipation is a function of frequency relative to peak
  - wave breaking has a maximum in the wavenumber domain
  - max spectral restoration occurs at intermediate wavelengths, caused by breaking of larger dominant waves
  - spectral dissipation is a function of wavenumber and spectral energy input
  - whitecapping dissipation depends on larger scales
  - two phase bubble dissipation also present
  - dissipation effect measured by comparing non-breaking with breaking wave spectrum to determine the dissipation due to breaking
  - breaking dependence on wind direction - directional spectrum

Conclusions:

1) No theoretical consensus exists concerning spectral dissipation of wave energy due to wave breaking 
2) Theory strongly disagrees with experiment
3) Experimental results disagree with each other

Wave-turbulence interactions
~~~~~~~~~~~~~~~~~~~~~~~~~~~~

* For wave periods > 10s viscosity has negigible effect - swells once generated were supposed to dissipate slowly due to the action of the wind, via the **"sheltering theory"** Jeffreys (1925)
* The sheltering theory was then replaced with **eddy viscosity analogies**. However, no evidence supports the idea that wave induced velocity profiles are unstable and become turbulent - except for the surface viscous layer (a few mm thick) and the wave bottom boundary layer. Therefore except in these two boundary layers, no theory justifies the use of eddy viscosity.
* Instead, apply **rapid distorsion theory** to model the stretching of eddies by wave motion or consider the **scattering of waves by turbulence**. Assume:

  - Eddy turnover time is less than wave period or
  - The strain rate of turbulence by wave motion is more than that of the turbulence by itself 
  - ... and the turbulent velocity is much less than the wave-induced velocity

* A large part of the momentum flux may be carried by long-lived and stable Langmuir rolls, so the weak modulation of the turbulent flux by the waves is possible.
* Turbulence is probably strongest at the peak of the wave groups where the Stokes drift is largest. This effect produces turbulence at larger depths than that produced by whitecaps.

Wave-wave modulations
~~~~~~~~~~~~~~~~~~~~~

* Exchange of energy and momentum takes place between the wind the long waves via the short waves and not between the waves and the ocean circulation and the turbulence.
* Modulations of wind stress can be significant:

  - **If the wind stress modulations are directed against the long waves, it dissipates them**
  - **If the wind stress modulations are directed with the long waves, it amplifies them**

* Modelling using **"rapid distortion theory"** of the air showed that the wind stress effect dissipates swells.
* As well as wind stress modulation, there is also surface roughness modulation, which may contribute to the growth of the waves in the wind direction.

Modelling the spectral dissipation function
-------------------------------------------

* Thus far spectral dissipation has been modelled by using "tuning knobs" rather than the parameterisation of the physics of the flow.
* Wave breaking dissipation mechanisms:

  - breaking threshold based on local spectral saturation
  - short wave extinction through cumulative nonlinear interaction with longer waves
  - failure to suppress low frequency spectral energy may result in return energy fluxes to the atmosphere that are up to a quarter of the wind-wave flux in magnitude

* History of the dissipation term:

  - considering the balance of source terms in order to obtain the known integral evolution curves
  - ensuring known spectrum development is satisfied, by validating spectral balance evolution
  - uncoupling the dissipation term from the source term balance in an attempt to tune it against known wave breaking characteristics
  - further tuning the standalone dissipation function against other dissipation-rlated properties and constraints (next step) **turbulent viscosity may play a role at small wave scales but not in white capping** and in shallow water the problem is more complex(!)
  - employing exact physics both experimental and theoretical (future)

WAVE PROPAGATION
================

* Wave propagation is on the LHS of the action balance equation consisting of the well-known effects of:

  - refraction
  - shoaling
  - diffraction
  - reflection

* Wave propagation is important for:

  - evolution of swells over long distances
  - variation of wave fields over narrow continental shelves

**Wave breaking is the largest source of upper ocean turbulence with profound influence on current velocity profiles**

Dispersion, geometrical optics and the wave action equation
-----------------------------------------------------------

Spectral description of wind-waves was introduced by **Pierson et al. (1955)** in order to account for the irregularity of waves at sea. Most models consider the waves as linear, but random and uniformly distributed.

The equation for spectral action density can by solved with Lagrangian (rays) or Eulerian coordinate systems.

Limitations of geometrical optics: diffraction, reflection and random scattering
--------------------------------------------------------------------------------

* Recent models are not phase resolving and don't account for interference patterns.
* Partial wave reflection is also ignored
* A proper form of the higher order scattering term is yet to be derived for random waves

Waves over varying currents, nonlinear wave effects and the advection velocity
------------------------------------------------------------------------------

* Describing waves varying over currents is important for forcasting and for the interpretation of remote-sensing observations. This applies to:

  - micro-wave radar
  - radiometers from satellites

* Measurements can be:

  - sea surface height
  - current
  - wave height
  - sea surface salinity
  - winds

* In those cases the instrument is sensitive to short (few centimeter) waves that are modulated by orbital velocities of the longer waves, with additional effects of surface slopes and accelerations.
* Also applies to high frequency radar (for mapping coastal currents)
* Short waves can be advected by long waves
* Current fronts may be a preferential site for wave breaking
* The Met Office only really considers tidal currents for practical weather forecasting. Quasi-geostrophic currents are not observed or well predicted enough for these calculations.
* Partial wave reflection may be important for the wave-current interactions that occur in Langmuir circulations.  

Waves blocking
--------------

* This is where currents oppose each other and stop wave propagation. However, the mechanism by which wave energy is removed at the blocking point is not understood yet.


Unsteady water depths and currents
----------------------------------

* Waves propagating over stationary currents have been considered. This holds true for quasi-stationary currents on timescales comparable with the propagation time of waves through the area. This is true for the Gulf Stream.
* Currents on continental shelves are likely due to tides (tidal currents). A tidal wave is faster than a wind wave, so is quasi-homogenous not quasi-stationary.

Waves in the real ocean
-----------------------

* Ice can attenuate waves propagating from the open ocean and prevents wind-wave generation of significance to the ice-free ocean.
* Swells can break up ice 
* Oil can also attenuate ice 
* Surface waves can interact with internal waves

NON-LINEAR INTERACTION IN DEEP WATER
====================================

Resonant, weakly nonlinear interactions between sets of four waves play an important role in the evolution of the energy spectrum of free surface gravity waves propagating at the ocean surface (JONSWAP Project)

Theory
------

The basic equation describing these interactions is the **Boltzmann integral**.


Solution Methods
----------------

* The Boltzmann integral is rather time consuming to solve due to it's complexity. 
* It has yet to reach operational wave prediction models.
* Various discrete solutions have been attempted

Questions and actions
---------------------

* The range of validity of the Boltzmann integral is not well known.
* The role of four wave interactions on long period swell waves has not yet been determined.
* Nobody has compared the numerical solutions to the Boltzmann integral


NON-LINEAR INTERACTION IN SHALLOW WATER
=======================================

There are two approaches here:

* Deterministic equations (e.g. Boussinesq equations or the fully non-linear equations)
* Stochastic models (i.e. models derived from the deterministic equations under a closure hypothesis - usually the random phase approximation is adopted)

Non-linearity in shallow water
------------------------------

As waves propagate from deep water into shallow coastal areas:

* frequency dispersion diminishes 
* quadratic near-resonances transform near-symmetric waves to skewed, pitched forward shapes
* the radiation of long waves at the 'beat' frequency of the incident wave field is induced ('surfbeat')

**Phenomena:**

* Boussinesq models assume uniform depth, weak dispersion and nonlinearity - i.e. very shallow water (although there have been some advances) 
* Variable depth theories assume the Stokes Number is O(1) i.e. nonlinearity :math:`a/h`, and dispersion :math:`(kh)^2` are assumed to be the same order
* The dispersion relation changes as waves propagate from deep to shallow water. The frequency spectrum is broadened and spectral components are phase-coupled causing the characteristic steepening and ptiching forward of near-breaking wave crests.

**Shallow water propagation models:**

1) Deterministic (phase resolving) models:

* These are derived from the Euler equation for potential flows (the Laplace equation plus boundary conditions). Assuming:

  - weak nonlinearity
  - in the limit of shallow water :math:`kh \rightarrow 0`

* These models include:

  - the physical domain Boussinesq models
  - the complex amplitude evolution models (spectral models)

2) Stochatic (phase-averaging) models:

* These are derived from the deterministic equations be applying a **turbulence-like closure hypothesis** to the infinite set of coupled equations governing the evolution of the spectral moments.
* For any deterministic model, a stochastic model can be developed.
* The closure hypothesis invariably introduces errors, so **the underlying deterministic model is more accurate than the stochastic model**.

As waves approach the shore, additional effects such as **bottom friction** and **depth-induced wave breaking** must be considered.

Deterministic models: time domain and spectral domain
-----------------------------------------------------

Time Domain
~~~~~~~~~~~

* Usually time-domain Boussinesq models
* Limited to spatial scales of around 10 wavelengths and operational nearshore wave prediction, as computational demands are prohibitive for large applications. Because:
  
  - Phase-resolving boundary conditions are usually not avaliable 
  - The need for wave field statistics - random directionally spread waves (as opposed to a single realisation) requires computation of multiple realisations

Spectral Domain
~~~~~~~~~~~~~~~

* (Complex) amplitude evolution or spectral models
* Superposition of plane waves (Fourier modes)
* Fourier models are attractive because:

  - They provide a natural continuation of the deep water approach.
  - Suited to handling processes of a statistical nature, e.g. dissipation and wind input.

* Similar to time-domain models, these are deterministic models and **Monte Carlo** simulations are needed for wave statistics

Stochastic models
-----------------

* Solve evolution equations for statistically averaged spectral wave properties.
* Comparison with experimental data shows good agreement outside the surf zone
* Higher order statistics (wave skewness and asymmetry) are less well predicted especially in the surf zone
* Advantages of stochastic models:

  - can predict statistical quantities directly without the need for repeated simulations
  - can be inisialised with direct measurements 

* Disadvantages of stochastic models:

  - no good over long distances (overly strong non-linearity and negative energy)

Dissipation and wave breaking in shallow water
----------------------------------------------

* Wave dissipation in the surf zone is not well understood and modelled heuristically.

Open problems
-------------

* Effects of bottom friction processes are not well understood
* With deterministic (phase resolving) models is it unclear how many Monte Carlo realisations are needed to obtain statistically reliable predictions of shallow water wave properties - but usually around 50 realizations are reported. It is a balance between accuracy and computing time.
* Stochastic models are more efficient, but less accurate over long distances or in highly non-linear or dissipative regions.
* Most models use a moderately sloped beach (1-5%) with 10 characteristic wavelengths and a sandy beach - most beaches are highly irregular.
* Reflections and standing waves are also ignored.

NUMERICS
========

* Choice of numerical scheme can result in large errors. 
* The central problem for numerics is **cartesian grids**
* **Why do we even use Cartesian grids?** Grids allow conservation terms to be rigorously enforced
* **So what's the problem?** Grids require high spatial and spectral resolution


Error due to low geographic resolution and low spectral resolution
------------------------------------------------------------------

The Problem
~~~~~~~~~~~

Errors are caused by:

* CFL number, which quantifies the number of grid spaces traversed by a packet of energy in one timestep. If ocean scale wind-forcing is present, the resolution depends on the **scale of the metrological features and the wave sensitivity to those features**.
* Relative resolution (i.e. the grid density w.r.t. what we are trying to resolve). Some geographic features may be completely left out in a 0.5 degree to 1 degree resolution global model.

Existing Solutions
~~~~~~~~~~~~~~~~~~

* Just increase the grid density (!) from 1 degree to 0.5 degrees. This increases the computing time and the required temporal resolution (to maintain stability).
* **High spectral resolution is mostly needed for swells** and swell attenuation is really linear.
* **Unstructured grids could provide efficient use of grid density, although may not be less diffusive.**
* High resolution is needed **when we are near the shore**

Future Solutions
~~~~~~~~~~~~~~~~

* **Unstructured grids** are expected to become more prevalent, since scales of variation are shorter near the shoreline. **Offshore wave fields only vary on the scale larger than that of the wind field.**

Error due to numerical scheme for geographic propagation
--------------------------------------------------------

The Problem
~~~~~~~~~~~

Numerical diffusion is the **smearing** of wave energy during propagation due to discretisation. It is not to be confused with **dissipation** which implies energy loss. It is caused by the **even-ordered** truncation error in the finite difference scheme. It is different from **numerical dispersion** which is caused by the **odd-ordered** truncation error. It depends on:

* CFL number
* May also depend on propagation direction


Existing Solutions
~~~~~~~~~~~~~~~~~~

There are two effects here:

1) Minimising numerical diffusion in the 1D case:

* Second order leapfrog scheme, which has zero numerical diffusion (WAM)
* Ultimate Quick-EST scheme and limiter, which is third order in 1D (WW3). Total variance diminishing limiters can be used to control wiggles.

2) The efficacy of the extension to 2D:

* Solve for both dimensions simultaneously
* Propagate each dimension in sequence (this decreases the order of accuracy)
* Implicit schemes in 2D, these are less efficient at oceanic scales (SWAN)
* Semi-Lagrangian schemes

Future Solutions
~~~~~~~~~~~~~~~~

**Semi-Lagrangian schemes** are an attractive alternative to traditional Euler schemes. However, there are two difficulties:

1) Assuring mass conservation is generally less straightforward than with Euler schemes
2) Source/sink terms must be applied along the ray at the Lagrangian stage - doing this computationally efficiently is a challenge.

Error due to the numerical scheme for spectral propagation
----------------------------------------------------------

The Problem
~~~~~~~~~~~

The **"Garden sprinkler effect"**. This where we can't resolve the spectral/frequency content and is due to numerical dispersion caused by truncation error. This is due to the **odd ordered** truncation error. It depends on:

* CFL number
* Relative resolution

Numerical dispersion can result in non-physical "wiggles" in the solution. We can counteract numerical dispersion by:

* Adding diffusion artificially
* Formulating diffusion and dispersion in roughly equal amounts.

Existing Solutions
~~~~~~~~~~~~~~~~~~

* Nobody wants to increase spectral resolution for this - due to computational cost.
* Controllable diffusion can be added
* Grid point averaging can be used
* Or an angular diffusive operator

Future Solutions
~~~~~~~~~~~~~~~~

* Let source/sink terms dictate frequency resolution and increase directional resolution as computing resources allow 
* Numerics and physics needs to become coupled through some parameterisations of physical processes.

Error due to source term integration
------------------------------------

The Problem
~~~~~~~~~~~

1st order Euler method requires time steps of around a few minutes, which is too computationally expensive. Various solutions such as semi-implicit methods with limiters have been tried, but are sensitive to time step size, especially for initial wave growth. 

Existing Solutions
~~~~~~~~~~~~~~~~~~

Three solutions:

1) Dynamically adjustment of timestep using a limiter for the maximum timestep. For large scale applications this is good. However, **for small scale applications (where wind and wave changes occur rapidly over the domain), this is bad because of the small timesteps involved.**

2) Limiter made proportional to step size - but this could prevent convergence. Can also remove limiter proportional to step size. 

3) Spreading numerical method - semi-analytical solution for integration source term, which includes wind-wave input, dissipation term, and exact non-linear energy transfer.

Future Solutions
~~~~~~~~~~~~~~~~

* Alternative non-convergent limiters
* Prototype for convergent limiter with reduced time step dependencies
